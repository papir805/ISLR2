---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

# Q15a)
```{r}
data(Boston)

names(Boston)

crim_by_zn = lm(crim ~ zn, data=Boston)
crim_by_indus = lm(crim ~ indus, data=Boston)
crim_by_chas = lm(crim ~ chas, data=Boston)
crim_by_nox = lm(crim ~ nox, data=Boston)
crim_by_rm = lm(crim ~ rm, data=Boston)
crim_by_age = lm(crim ~ age, data=Boston)
crim_by_dis = lm(crim ~ dis, data=Boston)
crim_by_rad = lm(crim ~ rad, data=Boston)
crim_by_tax = lm(crim ~ tax, data=Boston)
crim_by_ptratio = lm(crim ~ ptratio, data=Boston)
crim_by_lstat = lm(crim ~ lstat, data=Boston)
crim_by_medv = lm(crim ~ medv, data=Boston)
```

## Zone
Proportion of residential land zoned for lots over 25,000 sq.ft.
```{r}
# This predictor appears statistically significant
summary(crim_by_zn)
plot(Boston$zn, Boston$crim)
abline(crim_by_zn, col="red")
```
## Industry
Proportion of non-retail business acres per town
```{r}
# This predictor appears statistically significant
summary(crim_by_indus)
plot(Boston$indus, Boston$crim)
abline(crim_by_indus, col="red")
```
## Charles River Dummy Variable
=1 if track bounds river; 0 otherwise
```{r}
# This predictor IS NOT statistically significant
summary(crim_by_chas)
plot(Boston$chas, Boston$crim)
abline(crim_by_chas, col="red")
```
## Nox
Nitrogen Oxide Concentration (pp 10mil)
```{r}
# This predictor appears statistically significant
summary(crim_by_nox)
plot(Boston$nox, Boston$crim)
abline(crim_by_nox, col="red")
```

## Rooms
Average number of rooms per dwelling
```{r}
# This predictor appears statistically significant
summary(crim_by_rm)
plot(Boston$rm, Boston$crim)
abline(crim_by_rm, col="red")
```

## Age
Proportion of owner-occupied units built prior to 1940
```{r}
# This predictor appears statistically significant
summary(crim_by_age)
plot(Boston$age, Boston$crim)
abline(crim_by_age, col="red")
```
## Distsance
Weighted mean of distances to five Boston employment centres.
```{r}
# This predictor appears statistically significant
summary(crim_by_dis)
plot(Boston$dis, Boston$crim)
abline(crim_by_dis, col="red")
```
## Rad
Index of accessibility to radial highways
```{r}
# This predictor appears statistically significant
summary(crim_by_rad)
plot(Boston$rad, Boston$crim)
abline(crim_by_rad, col="red")
```
## Tax
Full-value property tax rate per $10,000
```{r}
# This predictor appears statistically significant
summary(crim_by_tax)
plot(Boston$tax, Boston$crim)
abline(crim_by_tax, col="red")
```
## Ptratio
Pupil-teacher ratio by town
```{r}
# This predictor appears statistically significant
summary(crim_by_ptratio)
plot(Boston$ptratio, Boston$crim)
abline(crim_by_ptratio, col="red")
```
## Lstat
Lower status of the population (percent).
```{r}
# This predictor appears statistically significant
summary(crim_by_lstat)
plot(Boston$lstat, Boston$crim)
abline(crim_by_lstat, col="red")
```
## Medv
Media value of owner-occupied homes in $1000s
```{r}
# This predictor appears statistically significant
summary(crim_by_medv)
plot(Boston$medv, Boston$crim)
abline(crim_by_medv, col="red")
```
# Q15b)
```{r}
crim_by_all = lm(crim ~ ., data=Boston)
summary(crim_by_all)
```
indus, dis, rad, and medv are the statistically significant features for which $H_0 : \beta_j = 0$.



# Q15c)
```{r}
y_coef = coef(crim_by_all)[-1]

x_coef = c(coef(crim_by_zn)[-1],
coef(crim_by_indus)[-1],
coef(crim_by_chas)[-1],
coef(crim_by_nox)[-1],
coef(crim_by_rm)[-1],
coef(crim_by_age)[-1],
coef(crim_by_dis)[-1],
coef(crim_by_rad)[-1],
coef(crim_by_tax)[-1],
coef(crim_by_ptratio)[-1],
coef(crim_by_lstat)[-1],
coef(crim_by_medv)[-1])
```


```{r}
crim_by_zn_non_linear = lm(crim ~ zn + I(zn^2) + I(zn^3),
                           data=Boston)

crim_by_indus_non_linear = lm(crim ~ indus + I(indusinstal^2) + I(indusinstal^3),
                              data=Boston)
crim_by_chas_non_linear = lm(crim ~ chas + I(zn^2) + I(zn^3), data=Boston)
crim_by_nox_non_linear = lm(crim ~ nox + I(zn^2) + I(zn^3), data=Boston)
crim_by_rm_non_linear = lm(crim ~ rm + I(zn^2) + I(zn^3), data=Boston)
crim_by_age_non_linear = lm(crim ~ age + I(zn^2) + I(zn^3), data=Boston)
crim_by_dis_non_linear = lm(crim ~ dis + I(zn^2) + I(zn^3), data=Boston)
crim_by_rad_non_linear = lm(crim ~ rad + I(zn^2) + I(zn^3), data=Boston)
crim_by_tax_non_linear = lm(crim ~ tax + I(zn^2) + I(zn^3), data=Boston)
crim_by_ptratio_non_linear = lm(crim ~ ptratio, data=Boston)
crim_by_lstat_non_linear = lm(crim ~ lstat + I(zn^2) + I(zn^3), data=Boston)
crim_by_medv_non_linear = lm(crim ~ medv + I(zn^2) + I(zn^3), data=Boston)
```